{
  "version": 3,
  "sources": ["../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/api-logs/src/types/LogRecord.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/api-logs/src/NoopLogger.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/api-logs/src/NoopLoggerProvider.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/api-logs/src/ProxyLogger.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/api-logs/src/ProxyLoggerProvider.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/api-logs/src/platform/node/globalThis.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/api-logs/src/platform/node/index.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/api-logs/src/platform/index.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/api-logs/src/internal/global-utils.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/api-logs/src/api/logs.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/api-logs/src/index.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/src/autoLoaderUtils.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/src/autoLoader.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/src/semver.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/src/shimmer.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/src/instrumentation.ts", "../../../node_modules/@prisma/instrumentation/node_modules/require-in-the-middle/index.js", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/src/platform/node/ModuleNameTrie.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/src/platform/node/RequireInTheMiddleSingleton.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/src/utils.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/src/platform/node/instrumentation.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/src/platform/node/normalize.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/src/platform/node/index.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/src/platform/index.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/src/instrumentationNodeModuleDefinition.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/src/instrumentationNodeModuleFile.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/src/semconvStability.ts", "../../../node_modules/@prisma/instrumentation/node_modules/@opentelemetry/instrumentation/src/index.ts", "../../../trigger.config.ts", "../../../node_modules/@prisma/instrumentation/dist/index.mjs"],
  "sourcesContent": ["/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Context, TimeInput } from '@opentelemetry/api';\nimport { AnyValue, AnyValueMap } from './AnyValue';\n\nexport type LogBody = AnyValue;\nexport type LogAttributes = AnyValueMap;\n\nexport enum SeverityNumber {\n  UNSPECIFIED = 0,\n  TRACE = 1,\n  TRACE2 = 2,\n  TRACE3 = 3,\n  TRACE4 = 4,\n  DEBUG = 5,\n  DEBUG2 = 6,\n  DEBUG3 = 7,\n  DEBUG4 = 8,\n  INFO = 9,\n  INFO2 = 10,\n  INFO3 = 11,\n  INFO4 = 12,\n  WARN = 13,\n  WARN2 = 14,\n  WARN3 = 15,\n  WARN4 = 16,\n  ERROR = 17,\n  ERROR2 = 18,\n  ERROR3 = 19,\n  ERROR4 = 20,\n  FATAL = 21,\n  FATAL2 = 22,\n  FATAL3 = 23,\n  FATAL4 = 24,\n}\n\nexport interface LogRecord {\n  /**\n   * The unique identifier for the log record.\n   */\n  eventName?: string;\n\n  /**\n   * The time when the log record occurred as UNIX Epoch time in nanoseconds.\n   */\n  timestamp?: TimeInput;\n\n  /**\n   * Time when the event was observed by the collection system.\n   */\n  observedTimestamp?: TimeInput;\n\n  /**\n   * Numerical value of the severity.\n   */\n  severityNumber?: SeverityNumber;\n\n  /**\n   * The severity text.\n   */\n  severityText?: string;\n\n  /**\n   * A value containing the body of the log record.\n   */\n  body?: LogBody;\n\n  /**\n   * Attributes that define the log record.\n   */\n  attributes?: LogAttributes;\n\n  /**\n   * The Context associated with the LogRecord.\n   */\n  context?: Context;\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Logger } from './types/Logger';\nimport { LogRecord } from './types/LogRecord';\n\nexport class NoopLogger implements Logger {\n  emit(_logRecord: LogRecord): void {}\n}\n\nexport const NOOP_LOGGER = new NoopLogger();\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { LoggerProvider } from './types/LoggerProvider';\nimport { Logger } from './types/Logger';\nimport { LoggerOptions } from './types/LoggerOptions';\nimport { NoopLogger } from './NoopLogger';\n\nexport class NoopLoggerProvider implements LoggerProvider {\n  getLogger(\n    _name: string,\n    _version?: string | undefined,\n    _options?: LoggerOptions | undefined\n  ): Logger {\n    return new NoopLogger();\n  }\n}\n\nexport const NOOP_LOGGER_PROVIDER = new NoopLoggerProvider();\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NOOP_LOGGER } from './NoopLogger';\nimport { Logger } from './types/Logger';\nimport { LoggerOptions } from './types/LoggerOptions';\nimport { LogRecord } from './types/LogRecord';\n\nexport class ProxyLogger implements Logger {\n  // When a real implementation is provided, this will be it\n  private _delegate?: Logger;\n\n  constructor(\n    private _provider: LoggerDelegator,\n    public readonly name: string,\n    public readonly version?: string | undefined,\n    public readonly options?: LoggerOptions | undefined\n  ) {}\n\n  /**\n   * Emit a log record. This method should only be used by log appenders.\n   *\n   * @param logRecord\n   */\n  emit(logRecord: LogRecord): void {\n    this._getLogger().emit(logRecord);\n  }\n\n  /**\n   * Try to get a logger from the proxy logger provider.\n   * If the proxy logger provider has no delegate, return a noop logger.\n   */\n  private _getLogger() {\n    if (this._delegate) {\n      return this._delegate;\n    }\n    const logger = this._provider._getDelegateLogger(\n      this.name,\n      this.version,\n      this.options\n    );\n    if (!logger) {\n      return NOOP_LOGGER;\n    }\n    this._delegate = logger;\n    return this._delegate;\n  }\n}\n\nexport interface LoggerDelegator {\n  _getDelegateLogger(\n    name: string,\n    version?: string,\n    options?: LoggerOptions\n  ): Logger | undefined;\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { LoggerProvider } from './types/LoggerProvider';\nimport { Logger } from './types/Logger';\nimport { LoggerOptions } from './types/LoggerOptions';\nimport { NOOP_LOGGER_PROVIDER } from './NoopLoggerProvider';\nimport { ProxyLogger } from './ProxyLogger';\n\nexport class ProxyLoggerProvider implements LoggerProvider {\n  private _delegate?: LoggerProvider;\n\n  getLogger(\n    name: string,\n    version?: string | undefined,\n    options?: LoggerOptions | undefined\n  ): Logger {\n    return (\n      this._getDelegateLogger(name, version, options) ??\n      new ProxyLogger(this, name, version, options)\n    );\n  }\n\n  /**\n   * Get the delegate logger provider.\n   * Used by tests only.\n   * @internal\n   */\n  _getDelegate(): LoggerProvider {\n    return this._delegate ?? NOOP_LOGGER_PROVIDER;\n  }\n\n  /**\n   * Set the delegate logger provider\n   * @internal\n   */\n  _setDelegate(delegate: LoggerProvider) {\n    this._delegate = delegate;\n  }\n\n  /**\n   * @internal\n   */\n  _getDelegateLogger(\n    name: string,\n    version?: string | undefined,\n    options?: LoggerOptions | undefined\n  ): Logger | undefined {\n    return this._delegate?.getLogger(name, version, options);\n  }\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** only globals that common to node and browsers are allowed */\n// eslint-disable-next-line n/no-unsupported-features/es-builtins\nexport const _globalThis = typeof globalThis === 'object' ? globalThis : global;\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport { _globalThis } from './globalThis';\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport { _globalThis } from './node';\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { LoggerProvider } from '../types/LoggerProvider';\nimport { _globalThis } from '../platform';\n\nexport const GLOBAL_LOGS_API_KEY = Symbol.for('io.opentelemetry.js.api.logs');\n\ntype Get<T> = (version: number) => T;\ntype OtelGlobal = Partial<{\n  [GLOBAL_LOGS_API_KEY]: Get<LoggerProvider>;\n}>;\n\nexport const _global = _globalThis as OtelGlobal;\n\n/**\n * Make a function which accepts a version integer and returns the instance of an API if the version\n * is compatible, or a fallback version (usually NOOP) if it is not.\n *\n * @param requiredVersion Backwards compatibility version which is required to return the instance\n * @param instance Instance which should be returned if the required version is compatible\n * @param fallback Fallback instance, usually NOOP, which will be returned if the required version is not compatible\n */\nexport function makeGetter<T>(\n  requiredVersion: number,\n  instance: T,\n  fallback: T\n): Get<T> {\n  return (version: number): T =>\n    version === requiredVersion ? instance : fallback;\n}\n\n/**\n * A number which should be incremented each time a backwards incompatible\n * change is made to the API. This number is used when an API package\n * attempts to access the global API to ensure it is getting a compatible\n * version. If the global API is not compatible with the API package\n * attempting to get it, a NOOP API implementation will be returned.\n */\nexport const API_BACKWARDS_COMPATIBILITY_VERSION = 1;\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  API_BACKWARDS_COMPATIBILITY_VERSION,\n  GLOBAL_LOGS_API_KEY,\n  _global,\n  makeGetter,\n} from '../internal/global-utils';\nimport { LoggerProvider } from '../types/LoggerProvider';\nimport { NOOP_LOGGER_PROVIDER } from '../NoopLoggerProvider';\nimport { Logger } from '../types/Logger';\nimport { LoggerOptions } from '../types/LoggerOptions';\nimport { ProxyLoggerProvider } from '../ProxyLoggerProvider';\n\nexport class LogsAPI {\n  private static _instance?: LogsAPI;\n\n  private _proxyLoggerProvider = new ProxyLoggerProvider();\n\n  private constructor() {}\n\n  public static getInstance(): LogsAPI {\n    if (!this._instance) {\n      this._instance = new LogsAPI();\n    }\n\n    return this._instance;\n  }\n\n  public setGlobalLoggerProvider(provider: LoggerProvider): LoggerProvider {\n    if (_global[GLOBAL_LOGS_API_KEY]) {\n      return this.getLoggerProvider();\n    }\n\n    _global[GLOBAL_LOGS_API_KEY] = makeGetter<LoggerProvider>(\n      API_BACKWARDS_COMPATIBILITY_VERSION,\n      provider,\n      NOOP_LOGGER_PROVIDER\n    );\n    this._proxyLoggerProvider._setDelegate(provider);\n\n    return provider;\n  }\n\n  /**\n   * Returns the global logger provider.\n   *\n   * @returns LoggerProvider\n   */\n  public getLoggerProvider(): LoggerProvider {\n    return (\n      _global[GLOBAL_LOGS_API_KEY]?.(API_BACKWARDS_COMPATIBILITY_VERSION) ??\n      this._proxyLoggerProvider\n    );\n  }\n\n  /**\n   * Returns a logger from the global logger provider.\n   *\n   * @returns Logger\n   */\n  public getLogger(\n    name: string,\n    version?: string,\n    options?: LoggerOptions\n  ): Logger {\n    return this.getLoggerProvider().getLogger(name, version, options);\n  }\n\n  /** Remove the global logger provider */\n  public disable(): void {\n    delete _global[GLOBAL_LOGS_API_KEY];\n    this._proxyLoggerProvider = new ProxyLoggerProvider();\n  }\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport type { Logger } from './types/Logger';\nexport type { LoggerProvider } from './types/LoggerProvider';\nexport { SeverityNumber } from './types/LogRecord';\nexport type { LogAttributes, LogBody, LogRecord } from './types/LogRecord';\nexport type { LoggerOptions } from './types/LoggerOptions';\nexport type { AnyValue, AnyValueMap } from './types/AnyValue';\nexport { NOOP_LOGGER, NoopLogger } from './NoopLogger';\nexport { NOOP_LOGGER_PROVIDER, NoopLoggerProvider } from './NoopLoggerProvider';\nexport { ProxyLogger } from './ProxyLogger';\nexport { ProxyLoggerProvider } from './ProxyLoggerProvider';\n\nimport { LogsAPI } from './api/logs';\nexport const logs = LogsAPI.getInstance();\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { TracerProvider, MeterProvider } from '@opentelemetry/api';\nimport { Instrumentation } from './types';\nimport { LoggerProvider } from '@opentelemetry/api-logs';\n\n/**\n * Enable instrumentations\n * @param instrumentations\n * @param tracerProvider\n * @param meterProvider\n */\nexport function enableInstrumentations(\n  instrumentations: Instrumentation[],\n  tracerProvider?: TracerProvider,\n  meterProvider?: MeterProvider,\n  loggerProvider?: LoggerProvider\n): void {\n  for (let i = 0, j = instrumentations.length; i < j; i++) {\n    const instrumentation = instrumentations[i];\n    if (tracerProvider) {\n      instrumentation.setTracerProvider(tracerProvider);\n    }\n    if (meterProvider) {\n      instrumentation.setMeterProvider(meterProvider);\n    }\n    if (loggerProvider && instrumentation.setLoggerProvider) {\n      instrumentation.setLoggerProvider(loggerProvider);\n    }\n    // instrumentations have been already enabled during creation\n    // so enable only if user prevented that by setting enabled to false\n    // this is to prevent double enabling but when calling register all\n    // instrumentations should be now enabled\n    if (!instrumentation.getConfig().enabled) {\n      instrumentation.enable();\n    }\n  }\n}\n\n/**\n * Disable instrumentations\n * @param instrumentations\n */\nexport function disableInstrumentations(\n  instrumentations: Instrumentation[]\n): void {\n  instrumentations.forEach(instrumentation => instrumentation.disable());\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { trace, metrics } from '@opentelemetry/api';\nimport { logs } from '@opentelemetry/api-logs';\nimport {\n  disableInstrumentations,\n  enableInstrumentations,\n} from './autoLoaderUtils';\nimport { AutoLoaderOptions } from './types_internal';\n\n/**\n * It will register instrumentations and plugins\n * @param options\n * @return returns function to unload instrumentation and plugins that were\n *   registered\n */\nexport function registerInstrumentations(\n  options: AutoLoaderOptions\n): () => void {\n  const tracerProvider = options.tracerProvider || trace.getTracerProvider();\n  const meterProvider = options.meterProvider || metrics.getMeterProvider();\n  const loggerProvider = options.loggerProvider || logs.getLoggerProvider();\n  const instrumentations = options.instrumentations?.flat() ?? [];\n\n  enableInstrumentations(\n    instrumentations,\n    tracerProvider,\n    meterProvider,\n    loggerProvider\n  );\n\n  return () => {\n    disableInstrumentations(instrumentations);\n  };\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// This is a custom semantic versioning implementation compatible with the\n// `satisfies(version, range, options?)` function from the `semver` npm package;\n// with the exception that the `loose` option is not supported.\n//\n// The motivation for the custom semver implementation is that\n// `semver` package has some initialization delay (lots of RegExp init and compile)\n// and this leads to coldstart overhead for the OTEL Lambda Node.js layer.\n// Hence, we have implemented lightweight version of it internally with required functionalities.\n\nimport { diag } from '@opentelemetry/api';\n\nconst VERSION_REGEXP =\n  /^(?:v)?(?<version>(?<major>0|[1-9]\\d*)\\.(?<minor>0|[1-9]\\d*)\\.(?<patch>0|[1-9]\\d*))(?:-(?<prerelease>(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+(?<build>[0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$/;\nconst RANGE_REGEXP =\n  /^(?<op><|>|=|==|<=|>=|~|\\^|~>)?\\s*(?:v)?(?<version>(?<major>x|X|\\*|0|[1-9]\\d*)(?:\\.(?<minor>x|X|\\*|0|[1-9]\\d*))?(?:\\.(?<patch>x|X|\\*|0|[1-9]\\d*))?)(?:-(?<prerelease>(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+(?<build>[0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$/;\n\nconst operatorResMap: { [op: string]: number[] } = {\n  '>': [1],\n  '>=': [0, 1],\n  '=': [0],\n  '<=': [-1, 0],\n  '<': [-1],\n  '!=': [-1, 1],\n};\n\n/** Interface for the options to configure semantic versioning satisfy check. */\nexport interface SatisfiesOptions {\n  /**\n   * If set to true, the pre-release checks will be included\n   * as described [here](https://github.com/npm/node-semver#prerelease-tags).\n   */\n  includePrerelease?: boolean;\n}\n\ninterface ParsedVersion {\n  op?: string;\n\n  version?: string;\n  versionSegments?: string[];\n  versionSegmentCount?: number;\n\n  prerelease?: string;\n  prereleaseSegments?: string[];\n  prereleaseSegmentCount?: number;\n\n  build?: string;\n\n  invalid?: boolean;\n}\n\n/**\n * Checks given version whether it satisfies given range expression.\n * @param version the [version](https://github.com/npm/node-semver#versions) to be checked\n * @param range   the [range](https://github.com/npm/node-semver#ranges) expression for version check\n * @param options options to configure semver satisfy check\n */\nexport function satisfies(\n  version: string,\n  range: string,\n  options?: SatisfiesOptions\n): boolean {\n  // Strict semver format check\n  if (!_validateVersion(version)) {\n    diag.error(`Invalid version: ${version}`);\n    return false;\n  }\n\n  // If range is empty, satisfy check succeeds regardless what version is\n  if (!range) {\n    return true;\n  }\n\n  // Cleanup range\n  range = range.replace(/([<>=~^]+)\\s+/g, '$1');\n\n  // Parse version\n  const parsedVersion: ParsedVersion | undefined = _parseVersion(version);\n  if (!parsedVersion) {\n    return false;\n  }\n\n  const allParsedRanges: ParsedVersion[] = [];\n\n  // Check given version whether it satisfies given range expression\n  const checkResult: boolean = _doSatisfies(\n    parsedVersion,\n    range,\n    allParsedRanges,\n    options\n  );\n\n  // If check result is OK,\n  // do another final check for pre-release, if pre-release check is included by option\n  if (checkResult && !options?.includePrerelease) {\n    return _doPreleaseCheck(parsedVersion, allParsedRanges);\n  }\n  return checkResult;\n}\n\nfunction _validateVersion(version: unknown): boolean {\n  return typeof version === 'string' && VERSION_REGEXP.test(version);\n}\n\nfunction _doSatisfies(\n  parsedVersion: ParsedVersion,\n  range: string,\n  allParsedRanges: ParsedVersion[],\n  options?: SatisfiesOptions\n): boolean {\n  if (range.includes('||')) {\n    // A version matches a range if and only if\n    // every comparator in at least one of the ||-separated comparator sets is satisfied by the version\n    const ranges: string[] = range.trim().split('||');\n    for (const r of ranges) {\n      if (_checkRange(parsedVersion, r, allParsedRanges, options)) {\n        return true;\n      }\n    }\n    return false;\n  } else if (range.includes(' - ')) {\n    // Hyphen ranges: https://github.com/npm/node-semver#hyphen-ranges-xyz---abc\n    range = replaceHyphen(range, options);\n  } else if (range.includes(' ')) {\n    // Multiple separated ranges and all needs to be satisfied for success\n    const ranges: string[] = range\n      .trim()\n      .replace(/\\s{2,}/g, ' ')\n      .split(' ');\n    for (const r of ranges) {\n      if (!_checkRange(parsedVersion, r, allParsedRanges, options)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  // Check given parsed version with given range\n  return _checkRange(parsedVersion, range, allParsedRanges, options);\n}\n\nfunction _checkRange(\n  parsedVersion: ParsedVersion,\n  range: string,\n  allParsedRanges: ParsedVersion[],\n  options?: SatisfiesOptions\n): boolean {\n  range = _normalizeRange(range, options);\n  if (range.includes(' ')) {\n    // If there are multiple ranges separated, satisfy each of them\n    return _doSatisfies(parsedVersion, range, allParsedRanges, options);\n  } else {\n    // Validate and parse range\n    const parsedRange: ParsedVersion = _parseRange(range);\n    allParsedRanges.push(parsedRange);\n    // Check parsed version by parsed range\n    return _satisfies(parsedVersion, parsedRange);\n  }\n}\n\nfunction _satisfies(\n  parsedVersion: ParsedVersion,\n  parsedRange: ParsedVersion\n): boolean {\n  // If range is invalid, satisfy check fails (no error throw)\n  if (parsedRange.invalid) {\n    return false;\n  }\n\n  // If range is empty or wildcard, satisfy check succeeds regardless what version is\n  if (!parsedRange.version || _isWildcard(parsedRange.version)) {\n    return true;\n  }\n\n  // Compare version segment first\n  let comparisonResult: number = _compareVersionSegments(\n    parsedVersion.versionSegments || [],\n    parsedRange.versionSegments || []\n  );\n\n  // If versions segments are equal, compare by pre-release segments\n  if (comparisonResult === 0) {\n    const versionPrereleaseSegments: string[] =\n      parsedVersion.prereleaseSegments || [];\n    const rangePrereleaseSegments: string[] =\n      parsedRange.prereleaseSegments || [];\n    if (!versionPrereleaseSegments.length && !rangePrereleaseSegments.length) {\n      comparisonResult = 0;\n    } else if (\n      !versionPrereleaseSegments.length &&\n      rangePrereleaseSegments.length\n    ) {\n      comparisonResult = 1;\n    } else if (\n      versionPrereleaseSegments.length &&\n      !rangePrereleaseSegments.length\n    ) {\n      comparisonResult = -1;\n    } else {\n      comparisonResult = _compareVersionSegments(\n        versionPrereleaseSegments,\n        rangePrereleaseSegments\n      );\n    }\n  }\n\n  // Resolve check result according to comparison operator\n  return operatorResMap[parsedRange.op!]?.includes(comparisonResult);\n}\n\nfunction _doPreleaseCheck(\n  parsedVersion: ParsedVersion,\n  allParsedRanges: ParsedVersion[]\n): boolean {\n  if (parsedVersion.prerelease) {\n    return allParsedRanges.some(\n      r => r.prerelease && r.version === parsedVersion.version\n    );\n  }\n  return true;\n}\n\nfunction _normalizeRange(range: string, options?: SatisfiesOptions): string {\n  range = range.trim();\n  range = replaceCaret(range, options);\n  range = replaceTilde(range);\n  range = replaceXRange(range, options);\n  range = range.trim();\n  return range;\n}\n\nfunction isX(id?: string): boolean {\n  return !id || id.toLowerCase() === 'x' || id === '*';\n}\n\nfunction _parseVersion(versionString: string): ParsedVersion | undefined {\n  const match: RegExpMatchArray | null = versionString.match(VERSION_REGEXP);\n  if (!match) {\n    diag.error(`Invalid version: ${versionString}`);\n    return undefined;\n  }\n\n  const version: string = match!.groups!.version;\n  const prerelease: string = match!.groups!.prerelease;\n  const build: string = match!.groups!.build;\n\n  const versionSegments: string[] = version.split('.');\n  const prereleaseSegments: string[] | undefined = prerelease?.split('.');\n\n  return {\n    op: undefined,\n\n    version,\n    versionSegments,\n    versionSegmentCount: versionSegments.length,\n\n    prerelease,\n    prereleaseSegments,\n    prereleaseSegmentCount: prereleaseSegments ? prereleaseSegments.length : 0,\n\n    build,\n  };\n}\n\nfunction _parseRange(rangeString: string): ParsedVersion {\n  if (!rangeString) {\n    return {};\n  }\n\n  const match: RegExpMatchArray | null = rangeString.match(RANGE_REGEXP);\n  if (!match) {\n    diag.error(`Invalid range: ${rangeString}`);\n    return {\n      invalid: true,\n    };\n  }\n\n  let op: string = match!.groups!.op;\n  const version: string = match!.groups!.version;\n  const prerelease: string = match!.groups!.prerelease;\n  const build: string = match!.groups!.build;\n\n  const versionSegments: string[] = version.split('.');\n  const prereleaseSegments: string[] | undefined = prerelease?.split('.');\n\n  if (op === '==') {\n    op = '=';\n  }\n\n  return {\n    op: op || '=',\n\n    version,\n    versionSegments,\n    versionSegmentCount: versionSegments.length,\n\n    prerelease,\n    prereleaseSegments,\n    prereleaseSegmentCount: prereleaseSegments ? prereleaseSegments.length : 0,\n\n    build,\n  };\n}\n\nfunction _isWildcard(s: string | undefined): boolean {\n  return s === '*' || s === 'x' || s === 'X';\n}\n\nfunction _parseVersionString(v: string): string | number {\n  const n: number = parseInt(v, 10);\n  return isNaN(n) ? v : n;\n}\n\nfunction _normalizeVersionType(\n  a: string | number,\n  b: string | number\n): [string, string] | [number, number] {\n  if (typeof a === typeof b) {\n    if (typeof a === 'number') {\n      return [a as number, b as number];\n    } else if (typeof a === 'string') {\n      return [a as string, b as string];\n    } else {\n      throw new Error('Version segments can only be strings or numbers');\n    }\n  } else {\n    return [String(a), String(b)];\n  }\n}\n\nfunction _compareVersionStrings(v1: string, v2: string): number {\n  if (_isWildcard(v1) || _isWildcard(v2)) {\n    return 0;\n  }\n  const [parsedV1, parsedV2] = _normalizeVersionType(\n    _parseVersionString(v1),\n    _parseVersionString(v2)\n  );\n  if (parsedV1 > parsedV2) {\n    return 1;\n  } else if (parsedV1 < parsedV2) {\n    return -1;\n  }\n  return 0;\n}\n\nfunction _compareVersionSegments(v1: string[], v2: string[]): number {\n  for (let i = 0; i < Math.max(v1.length, v2.length); i++) {\n    const res: number = _compareVersionStrings(v1[i] || '0', v2[i] || '0');\n    if (res !== 0) {\n      return res;\n    }\n  }\n  return 0;\n}\n\n////////////////////////////////////////////////////////////////////////////////\n// The rest of this file is adapted from portions of https://github.com/npm/node-semver/tree/868d4bb\n// License:\n/*\n * The ISC License\n *\n * Copyright (c) Isaac Z. Schlueter and Contributors\n *\n * Permission to use, copy, modify, and/or distribute this software for any\n * purpose with or without fee is hereby granted, provided that the above\n * copyright notice and this permission notice appear in all copies.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES\n * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF\n * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR\n * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES\n * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN\n * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR\n * IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\n */\n\nconst LETTERDASHNUMBER = '[a-zA-Z0-9-]';\nconst NUMERICIDENTIFIER = '0|[1-9]\\\\d*';\nconst NONNUMERICIDENTIFIER = `\\\\d*[a-zA-Z-]${LETTERDASHNUMBER}*`;\nconst GTLT = '((?:<|>)?=?)';\n\nconst PRERELEASEIDENTIFIER = `(?:${NUMERICIDENTIFIER}|${NONNUMERICIDENTIFIER})`;\nconst PRERELEASE = `(?:-(${PRERELEASEIDENTIFIER}(?:\\\\.${PRERELEASEIDENTIFIER})*))`;\n\nconst BUILDIDENTIFIER = `${LETTERDASHNUMBER}+`;\nconst BUILD = `(?:\\\\+(${BUILDIDENTIFIER}(?:\\\\.${BUILDIDENTIFIER})*))`;\n\nconst XRANGEIDENTIFIER = `${NUMERICIDENTIFIER}|x|X|\\\\*`;\nconst XRANGEPLAIN =\n  `[v=\\\\s]*(${XRANGEIDENTIFIER})` +\n  `(?:\\\\.(${XRANGEIDENTIFIER})` +\n  `(?:\\\\.(${XRANGEIDENTIFIER})` +\n  `(?:${PRERELEASE})?${BUILD}?` +\n  `)?)?`;\nconst XRANGE = `^${GTLT}\\\\s*${XRANGEPLAIN}$`;\nconst XRANGE_REGEXP = new RegExp(XRANGE);\n\nconst HYPHENRANGE =\n  `^\\\\s*(${XRANGEPLAIN})` + `\\\\s+-\\\\s+` + `(${XRANGEPLAIN})` + `\\\\s*$`;\nconst HYPHENRANGE_REGEXP = new RegExp(HYPHENRANGE);\n\nconst LONETILDE = '(?:~>?)';\nconst TILDE = `^${LONETILDE}${XRANGEPLAIN}$`;\nconst TILDE_REGEXP = new RegExp(TILDE);\n\nconst LONECARET = '(?:\\\\^)';\nconst CARET = `^${LONECARET}${XRANGEPLAIN}$`;\nconst CARET_REGEXP = new RegExp(CARET);\n\n// Borrowed from https://github.com/npm/node-semver/blob/868d4bbe3d318c52544f38d5f9977a1103e924c2/classes/range.js#L285\n//\n// ~, ~> --> * (any, kinda silly)\n// ~2, ~2.x, ~2.x.x, ~>2, ~>2.x ~>2.x.x --> >=2.0.0 <3.0.0-0\n// ~2.0, ~2.0.x, ~>2.0, ~>2.0.x --> >=2.0.0 <2.1.0-0\n// ~1.2, ~1.2.x, ~>1.2, ~>1.2.x --> >=1.2.0 <1.3.0-0\n// ~1.2.3, ~>1.2.3 --> >=1.2.3 <1.3.0-0\n// ~1.2.0, ~>1.2.0 --> >=1.2.0 <1.3.0-0\n// ~0.0.1 --> >=0.0.1 <0.1.0-0\nfunction replaceTilde(comp: string): string {\n  const r = TILDE_REGEXP;\n  return comp.replace(r, (_, M, m, p, pr) => {\n    let ret;\n\n    if (isX(M)) {\n      ret = '';\n    } else if (isX(m)) {\n      ret = `>=${M}.0.0 <${+M + 1}.0.0-0`;\n    } else if (isX(p)) {\n      // ~1.2 == >=1.2.0 <1.3.0-0\n      ret = `>=${M}.${m}.0 <${M}.${+m + 1}.0-0`;\n    } else if (pr) {\n      ret = `>=${M}.${m}.${p}-${pr} <${M}.${+m + 1}.0-0`;\n    } else {\n      // ~1.2.3 == >=1.2.3 <1.3.0-0\n      ret = `>=${M}.${m}.${p} <${M}.${+m + 1}.0-0`;\n    }\n    return ret;\n  });\n}\n\n// Borrowed from https://github.com/npm/node-semver/blob/868d4bbe3d318c52544f38d5f9977a1103e924c2/classes/range.js#L329\n//\n// ^ --> * (any, kinda silly)\n// ^2, ^2.x, ^2.x.x --> >=2.0.0 <3.0.0-0\n// ^2.0, ^2.0.x --> >=2.0.0 <3.0.0-0\n// ^1.2, ^1.2.x --> >=1.2.0 <2.0.0-0\n// ^1.2.3 --> >=1.2.3 <2.0.0-0\n// ^1.2.0 --> >=1.2.0 <2.0.0-0\n// ^0.0.1 --> >=0.0.1 <0.0.2-0\n// ^0.1.0 --> >=0.1.0 <0.2.0-0\nfunction replaceCaret(comp: string, options?: SatisfiesOptions): string {\n  const r = CARET_REGEXP;\n  const z = options?.includePrerelease ? '-0' : '';\n  return comp.replace(r, (_, M, m, p, pr) => {\n    let ret;\n\n    if (isX(M)) {\n      ret = '';\n    } else if (isX(m)) {\n      ret = `>=${M}.0.0${z} <${+M + 1}.0.0-0`;\n    } else if (isX(p)) {\n      if (M === '0') {\n        ret = `>=${M}.${m}.0${z} <${M}.${+m + 1}.0-0`;\n      } else {\n        ret = `>=${M}.${m}.0${z} <${+M + 1}.0.0-0`;\n      }\n    } else if (pr) {\n      if (M === '0') {\n        if (m === '0') {\n          ret = `>=${M}.${m}.${p}-${pr} <${M}.${m}.${+p + 1}-0`;\n        } else {\n          ret = `>=${M}.${m}.${p}-${pr} <${M}.${+m + 1}.0-0`;\n        }\n      } else {\n        ret = `>=${M}.${m}.${p}-${pr} <${+M + 1}.0.0-0`;\n      }\n    } else {\n      if (M === '0') {\n        if (m === '0') {\n          ret = `>=${M}.${m}.${p}${z} <${M}.${m}.${+p + 1}-0`;\n        } else {\n          ret = `>=${M}.${m}.${p}${z} <${M}.${+m + 1}.0-0`;\n        }\n      } else {\n        ret = `>=${M}.${m}.${p} <${+M + 1}.0.0-0`;\n      }\n    }\n    return ret;\n  });\n}\n\n// Borrowed from https://github.com/npm/node-semver/blob/868d4bbe3d318c52544f38d5f9977a1103e924c2/classes/range.js#L390\nfunction replaceXRange(comp: string, options?: SatisfiesOptions): string {\n  const r = XRANGE_REGEXP;\n  return comp.replace(r, (ret, gtlt, M, m, p, pr) => {\n    const xM = isX(M);\n    const xm = xM || isX(m);\n    const xp = xm || isX(p);\n    const anyX = xp;\n\n    if (gtlt === '=' && anyX) {\n      gtlt = '';\n    }\n\n    // if we're including prereleases in the match, then we need\n    // to fix this to -0, the lowest possible prerelease value\n    pr = options?.includePrerelease ? '-0' : '';\n\n    if (xM) {\n      if (gtlt === '>' || gtlt === '<') {\n        // nothing is allowed\n        ret = '<0.0.0-0';\n      } else {\n        // nothing is forbidden\n        ret = '*';\n      }\n    } else if (gtlt && anyX) {\n      // we know patch is an x, because we have any x at all.\n      // replace X with 0\n      if (xm) {\n        m = 0;\n      }\n      p = 0;\n\n      if (gtlt === '>') {\n        // >1 => >=2.0.0\n        // >1.2 => >=1.3.0\n        gtlt = '>=';\n        if (xm) {\n          M = +M + 1;\n          m = 0;\n          p = 0;\n        } else {\n          m = +m + 1;\n          p = 0;\n        }\n      } else if (gtlt === '<=') {\n        // <=0.7.x is actually <0.8.0, since any 0.7.x should\n        // pass.  Similarly, <=7.x is actually <8.0.0, etc.\n        gtlt = '<';\n        if (xm) {\n          M = +M + 1;\n        } else {\n          m = +m + 1;\n        }\n      }\n\n      if (gtlt === '<') {\n        pr = '-0';\n      }\n\n      ret = `${gtlt + M}.${m}.${p}${pr}`;\n    } else if (xm) {\n      ret = `>=${M}.0.0${pr} <${+M + 1}.0.0-0`;\n    } else if (xp) {\n      ret = `>=${M}.${m}.0${pr} <${M}.${+m + 1}.0-0`;\n    }\n\n    return ret;\n  });\n}\n\n// Borrowed from https://github.com/npm/node-semver/blob/868d4bbe3d318c52544f38d5f9977a1103e924c2/classes/range.js#L488\n//\n// 1.2 - 3.4.5 => >=1.2.0 <=3.4.5\n// 1.2.3 - 3.4 => >=1.2.0 <3.5.0-0 Any 3.4.x will do\n// 1.2 - 3.4 => >=1.2.0 <3.5.0-0\nfunction replaceHyphen(comp: string, options?: SatisfiesOptions): string {\n  const r = HYPHENRANGE_REGEXP;\n  return comp.replace(\n    r,\n    (_, from, fM, fm, fp, fpr, fb, to, tM, tm, tp, tpr) => {\n      if (isX(fM)) {\n        from = '';\n      } else if (isX(fm)) {\n        from = `>=${fM}.0.0${options?.includePrerelease ? '-0' : ''}`;\n      } else if (isX(fp)) {\n        from = `>=${fM}.${fm}.0${options?.includePrerelease ? '-0' : ''}`;\n      } else if (fpr) {\n        from = `>=${from}`;\n      } else {\n        from = `>=${from}${options?.includePrerelease ? '-0' : ''}`;\n      }\n\n      if (isX(tM)) {\n        to = '';\n      } else if (isX(tm)) {\n        to = `<${+tM + 1}.0.0-0`;\n      } else if (isX(tp)) {\n        to = `<${tM}.${+tm + 1}.0-0`;\n      } else if (tpr) {\n        to = `<=${tM}.${tm}.${tp}-${tpr}`;\n      } else if (options?.includePrerelease) {\n        to = `<${tM}.${tm}.${+tp + 1}-0`;\n      } else {\n        to = `<=${to}`;\n      }\n\n      return `${from} ${to}`.trim();\n    }\n  );\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/*\n * BSD 2-Clause License\n *\n * Copyright (c) 2013-2019, Forrest L Norvell\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * * Redistributions of source code must retain the above copyright notice, this\n *   list of conditions and the following disclaimer.\n *\n * * Redistributions in binary form must reproduce the above copyright notice,\n *   this list of conditions and the following disclaimer in the documentation\n *   and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* Modified by OpenTelemetry Authors\n *  - converted to TypeScript\n *  - aligned with style-guide\n */\n\nimport { ShimWrapped } from './types';\n\n// Default to complaining loudly when things don't go according to plan.\n// eslint-disable-next-line no-console\nlet logger: typeof console.error = console.error.bind(console);\n\n// Sets a property on an object, preserving its enumerability.\n// This function assumes that the property is already writable.\nfunction defineProperty(obj: object, name: PropertyKey, value: unknown): void {\n  const enumerable =\n    !!obj[name as keyof typeof obj] &&\n    Object.prototype.propertyIsEnumerable.call(obj, name);\n\n  Object.defineProperty(obj, name, {\n    configurable: true,\n    enumerable,\n    writable: true,\n    value,\n  });\n}\n\nexport const wrap = <Nodule extends object, FieldName extends keyof Nodule>(\n  nodule: Nodule,\n  name: FieldName,\n  wrapper: (original: Nodule[FieldName], name: FieldName) => Nodule[FieldName]\n): ShimWrapped | undefined => {\n  if (!nodule || !nodule[name]) {\n    logger('no original function ' + String(name) + ' to wrap');\n    return;\n  }\n\n  if (!wrapper) {\n    logger('no wrapper function');\n    logger(new Error().stack);\n    return;\n  }\n\n  const original = nodule[name];\n\n  if (typeof original !== 'function' || typeof wrapper !== 'function') {\n    logger('original object and wrapper must be functions');\n    return;\n  }\n\n  const wrapped = wrapper(original, name) as object;\n\n  defineProperty(wrapped, '__original', original);\n  defineProperty(wrapped, '__unwrap', () => {\n    if (nodule[name] === wrapped) {\n      defineProperty(nodule, name, original);\n    }\n  });\n  defineProperty(wrapped, '__wrapped', true);\n  defineProperty(nodule, name, wrapped);\n  return wrapped as ShimWrapped;\n};\n\nexport const massWrap = <Nodule extends object, FieldName extends keyof Nodule>(\n  nodules: Nodule[],\n  names: FieldName[],\n  wrapper: (original: Nodule[FieldName]) => Nodule[FieldName]\n): void => {\n  if (!nodules) {\n    logger('must provide one or more modules to patch');\n    logger(new Error().stack);\n    return;\n  } else if (!Array.isArray(nodules)) {\n    nodules = [nodules];\n  }\n\n  if (!(names && Array.isArray(names))) {\n    logger('must provide one or more functions to wrap on modules');\n    return;\n  }\n\n  nodules.forEach(nodule => {\n    names.forEach(name => {\n      wrap(nodule, name, wrapper);\n    });\n  });\n};\n\nexport const unwrap = <Nodule extends object>(\n  nodule: Nodule,\n  name: keyof Nodule\n): void => {\n  if (!nodule || !nodule[name]) {\n    logger('no function to unwrap.');\n    logger(new Error().stack);\n    return;\n  }\n\n  const wrapped = nodule[name] as unknown as ShimWrapped;\n\n  if (!wrapped.__unwrap) {\n    logger(\n      'no original to unwrap to -- has ' +\n        String(name) +\n        ' already been unwrapped?'\n    );\n  } else {\n    wrapped.__unwrap();\n    return;\n  }\n};\n\nexport const massUnwrap = <Nodule extends object>(\n  nodules: Nodule[],\n  names: Array<keyof Nodule>\n): void => {\n  if (!nodules) {\n    logger('must provide one or more modules to patch');\n    logger(new Error().stack);\n    return;\n  } else if (!Array.isArray(nodules)) {\n    nodules = [nodules];\n  }\n\n  if (!(names && Array.isArray(names))) {\n    logger('must provide one or more functions to unwrap on modules');\n    return;\n  }\n\n  nodules.forEach(nodule => {\n    names.forEach(name => {\n      unwrap(nodule, name);\n    });\n  });\n};\n\nexport interface ShimmerOptions {\n  logger?: typeof console.error;\n}\n\nexport default function shimmer(options: ShimmerOptions): void {\n  if (options && options.logger) {\n    if (typeof options.logger !== 'function') {\n      logger(\"new logger isn't a function, not replacing\");\n    } else {\n      logger = options.logger;\n    }\n  }\n}\n\nshimmer.wrap = wrap;\nshimmer.massWrap = massWrap;\nshimmer.unwrap = unwrap;\nshimmer.massUnwrap = massUnwrap;\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  diag,\n  DiagLogger,\n  metrics,\n  Meter,\n  MeterProvider,\n  trace,\n  Tracer,\n  TracerProvider,\n  Span,\n} from '@opentelemetry/api';\nimport { Logger, LoggerProvider, logs } from '@opentelemetry/api-logs';\nimport * as shimmer from './shimmer';\nimport {\n  InstrumentationModuleDefinition,\n  Instrumentation,\n  InstrumentationConfig,\n  SpanCustomizationHook,\n} from './types';\n\n/**\n * Base abstract internal class for instrumenting node and web plugins\n */\nexport abstract class InstrumentationAbstract<\n  ConfigType extends InstrumentationConfig = InstrumentationConfig,\n> implements Instrumentation<ConfigType>\n{\n  protected _config: ConfigType = {} as ConfigType;\n\n  private _tracer: Tracer;\n  private _meter: Meter;\n  private _logger: Logger;\n  protected _diag: DiagLogger;\n\n  constructor(\n    public readonly instrumentationName: string,\n    public readonly instrumentationVersion: string,\n    config: ConfigType\n  ) {\n    this.setConfig(config);\n\n    this._diag = diag.createComponentLogger({\n      namespace: instrumentationName,\n    });\n\n    this._tracer = trace.getTracer(instrumentationName, instrumentationVersion);\n    this._meter = metrics.getMeter(instrumentationName, instrumentationVersion);\n    this._logger = logs.getLogger(instrumentationName, instrumentationVersion);\n    this._updateMetricInstruments();\n  }\n\n  /* Api to wrap instrumented method */\n  protected _wrap = shimmer.wrap;\n  /* Api to unwrap instrumented methods */\n  protected _unwrap = shimmer.unwrap;\n  /* Api to mass wrap instrumented method */\n  protected _massWrap = shimmer.massWrap;\n  /* Api to mass unwrap instrumented methods */\n  protected _massUnwrap = shimmer.massUnwrap;\n\n  /* Returns meter */\n  protected get meter(): Meter {\n    return this._meter;\n  }\n\n  /**\n   * Sets MeterProvider to this plugin\n   * @param meterProvider\n   */\n  public setMeterProvider(meterProvider: MeterProvider): void {\n    this._meter = meterProvider.getMeter(\n      this.instrumentationName,\n      this.instrumentationVersion\n    );\n\n    this._updateMetricInstruments();\n  }\n\n  /* Returns logger */\n  protected get logger(): Logger {\n    return this._logger;\n  }\n\n  /**\n   * Sets LoggerProvider to this plugin\n   * @param loggerProvider\n   */\n  public setLoggerProvider(loggerProvider: LoggerProvider): void {\n    this._logger = loggerProvider.getLogger(\n      this.instrumentationName,\n      this.instrumentationVersion\n    );\n  }\n\n  /**\n   * @experimental\n   *\n   * Get module definitions defined by {@link init}.\n   * This can be used for experimental compile-time instrumentation.\n   *\n   * @returns an array of {@link InstrumentationModuleDefinition}\n   */\n  public getModuleDefinitions(): InstrumentationModuleDefinition[] {\n    const initResult = this.init() ?? [];\n    if (!Array.isArray(initResult)) {\n      return [initResult];\n    }\n\n    return initResult;\n  }\n\n  /**\n   * Sets the new metric instruments with the current Meter.\n   */\n  protected _updateMetricInstruments(): void {\n    return;\n  }\n\n  /* Returns InstrumentationConfig */\n  public getConfig(): ConfigType {\n    return this._config;\n  }\n\n  /**\n   * Sets InstrumentationConfig to this plugin\n   * @param config\n   */\n  public setConfig(config: ConfigType): void {\n    // copy config first level properties to ensure they are immutable.\n    // nested properties are not copied, thus are mutable from the outside.\n    this._config = {\n      enabled: true,\n      ...config,\n    };\n  }\n\n  /**\n   * Sets TraceProvider to this plugin\n   * @param tracerProvider\n   */\n  public setTracerProvider(tracerProvider: TracerProvider): void {\n    this._tracer = tracerProvider.getTracer(\n      this.instrumentationName,\n      this.instrumentationVersion\n    );\n  }\n\n  /* Returns tracer */\n  protected get tracer(): Tracer {\n    return this._tracer;\n  }\n\n  /* Enable plugin */\n  public abstract enable(): void;\n\n  /* Disable plugin */\n  public abstract disable(): void;\n\n  /**\n   * Init method in which plugin should define _modules and patches for\n   * methods.\n   */\n  protected abstract init():\n    | InstrumentationModuleDefinition\n    | InstrumentationModuleDefinition[]\n    | void;\n\n  /**\n   * Execute span customization hook, if configured, and log any errors.\n   * Any semantics of the trigger and info are defined by the specific instrumentation.\n   * @param hookHandler The optional hook handler which the user has configured via instrumentation config\n   * @param triggerName The name of the trigger for executing the hook for logging purposes\n   * @param span The span to which the hook should be applied\n   * @param info The info object to be passed to the hook, with useful data the hook may use\n   */\n  protected _runSpanCustomizationHook<SpanCustomizationInfoType>(\n    hookHandler: SpanCustomizationHook<SpanCustomizationInfoType> | undefined,\n    triggerName: string,\n    span: Span,\n    info: SpanCustomizationInfoType\n  ) {\n    if (!hookHandler) {\n      return;\n    }\n\n    try {\n      hookHandler(span, info);\n    } catch (e) {\n      this._diag.error(\n        `Error running span customization hook due to exception in handler`,\n        { triggerName },\n        e\n      );\n    }\n  }\n}\n", "'use strict'\n\nconst path = require('path')\nconst Module = require('module')\nconst debug = require('debug')('require-in-the-middle')\nconst moduleDetailsFromPath = require('module-details-from-path')\n\n// Using the default export is discouraged, but kept for backward compatibility.\n// Use this instead:\n//    const { Hook } = require('require-in-the-middle')\nmodule.exports = Hook\nmodule.exports.Hook = Hook\n\nlet builtinModules // Set<string>\n\n/**\n * Is the given module a \"core\" module?\n * https://nodejs.org/api/modules.html#core-modules\n *\n * @type {(moduleName: string) => boolean}\n */\nlet isCore\nif (Module.isBuiltin) { // Added in node v18.6.0, v16.17.0\n  isCore = Module.isBuiltin\n} else if (Module.builtinModules) { // Added in node v9.3.0, v8.10.0, v6.13.0\n  isCore = moduleName => {\n    if (moduleName.startsWith('node:')) {\n      return true\n    }\n\n    if (builtinModules === undefined) {\n      builtinModules = new Set(Module.builtinModules)\n    }\n\n    return builtinModules.has(moduleName)\n  }\n} else {\n  throw new Error('\\'require-in-the-middle\\' requires Node.js >=v9.3.0 or >=v8.10.0')\n}\n\n// 'foo/bar.js' or 'foo/bar/index.js' => 'foo/bar'\nconst normalize = /([/\\\\]index)?(\\.js)?$/\n\n// Cache `onrequire`-patched exports for modules.\n//\n// Exports for built-in (a.k.a. \"core\") modules are stored in an internal Map.\n//\n// Exports for non-core modules are stored on a private field on the `Module`\n// object in `require.cache`. This allows users to delete from `require.cache`\n// to trigger a re-load (and re-run of the hook's `onrequire`) of a module the\n// next time it is required.\n// https://nodejs.org/docs/latest/api/all.html#all_modules_requirecache\n//\n// In some special cases -- e.g. some other `require()` hook swapping out\n// `Module._cache` like `@babel/register` -- a non-core module won't be in\n// `require.cache`. In that case this falls back to caching on the internal Map.\nclass ExportsCache {\n  constructor () {\n    this._localCache = new Map() // <module filename or id> -> <exports>\n    this._kRitmExports = Symbol('RitmExports')\n  }\n\n  has (filename, isBuiltin) {\n    if (this._localCache.has(filename)) {\n      return true\n    } else if (!isBuiltin) {\n      const mod = require.cache[filename]\n      return !!(mod && this._kRitmExports in mod)\n    } else {\n      return false\n    }\n  }\n\n  get (filename, isBuiltin) {\n    const cachedExports = this._localCache.get(filename)\n    if (cachedExports !== undefined) {\n      return cachedExports\n    } else if (!isBuiltin) {\n      const mod = require.cache[filename]\n      return (mod && mod[this._kRitmExports])\n    }\n  }\n\n  set (filename, exports, isBuiltin) {\n    if (isBuiltin) {\n      this._localCache.set(filename, exports)\n    } else if (filename in require.cache) {\n      require.cache[filename][this._kRitmExports] = exports\n    } else {\n      debug('non-core module is unexpectedly not in require.cache: \"%s\"', filename)\n      this._localCache.set(filename, exports)\n    }\n  }\n}\n\nfunction Hook (modules, options, onrequire) {\n  if ((this instanceof Hook) === false) return new Hook(modules, options, onrequire)\n  if (typeof modules === 'function') {\n    onrequire = modules\n    modules = null\n    options = null\n  } else if (typeof options === 'function') {\n    onrequire = options\n    options = null\n  }\n\n  if (typeof Module._resolveFilename !== 'function') {\n    console.error('Error: Expected Module._resolveFilename to be a function (was: %s) - aborting!', typeof Module._resolveFilename)\n    console.error('Please report this error as an issue related to Node.js %s at https://github.com/nodejs/require-in-the-middle/issues', process.version)\n    return\n  }\n\n  this._cache = new ExportsCache()\n\n  this._unhooked = false\n  this._origRequire = Module.prototype.require\n\n  const self = this\n  const patching = new Set()\n  const internals = options ? options.internals === true : false\n  const hasWhitelist = Array.isArray(modules)\n\n  debug('registering require hook')\n\n  this._require = Module.prototype.require = function (id) {\n    if (self._unhooked === true) {\n      // if the patched require function could not be removed because\n      // someone else patched it after it was patched here, we just\n      // abort and pass the request onwards to the original require\n      debug('ignoring require call - module is soft-unhooked')\n      return self._origRequire.apply(this, arguments)\n    }\n\n    return patchedRequire.call(this, arguments, false)\n  }\n\n  if (typeof process.getBuiltinModule === 'function') {\n    this._origGetBuiltinModule = process.getBuiltinModule\n    this._getBuiltinModule = process.getBuiltinModule = function (id) {\n      if (self._unhooked === true) {\n        // if the patched process.getBuiltinModule function could not be removed because\n        // someone else patched it after it was patched here, we just abort and pass the\n        // request onwards to the original process.getBuiltinModule\n        debug('ignoring process.getBuiltinModule call - module is soft-unhooked')\n        return self._origGetBuiltinModule.apply(this, arguments)\n      }\n\n      return patchedRequire.call(this, arguments, true)\n    }\n  }\n\n  // Preserve the original require/process.getBuiltinModule arguments in `args`\n  function patchedRequire (args, coreOnly) {\n    const id = args[0]\n    const core = isCore(id)\n    let filename // the string used for caching\n    if (core) {\n      filename = id\n      // If this is a builtin module that can be identified both as 'foo' and\n      // 'node:foo', then prefer 'foo' as the caching key.\n      if (id.startsWith('node:')) {\n        const idWithoutPrefix = id.slice(5)\n        if (isCore(idWithoutPrefix)) {\n          filename = idWithoutPrefix\n        }\n      }\n    } else if (coreOnly) {\n      // `coreOnly` is `true` if this was a call to `process.getBuiltinModule`, in which case\n      // we don't want to return anything if the requested `id` isn't a core module. Falling\n      // back to default behaviour, which at the time of this wrting is simply returning `undefined`\n      debug('call to process.getBuiltinModule with unknown built-in id')\n      return self._origGetBuiltinModule.apply(this, args)\n    } else {\n      try {\n        filename = Module._resolveFilename(id, this)\n      } catch (resolveErr) {\n        // If someone *else* monkey-patches before this monkey-patch, then that\n        // code might expect `require(someId)` to get through so it can be\n        // handled, even if `someId` cannot be resolved to a filename. In this\n        // case, instead of throwing we defer to the underlying `require`.\n        //\n        // For example the Azure Functions Node.js worker module does this,\n        // where `@azure/functions-core` resolves to an internal object.\n        // https://github.com/Azure/azure-functions-nodejs-worker/blob/v3.5.2/src/setupCoreModule.ts#L46-L54\n        debug('Module._resolveFilename(\"%s\") threw %j, calling original Module.require', id, resolveErr.message)\n        return self._origRequire.apply(this, args)\n      }\n    }\n\n    let moduleName, basedir\n\n    debug('processing %s module require(\\'%s\\'): %s', core === true ? 'core' : 'non-core', id, filename)\n\n    // return known patched modules immediately\n    if (self._cache.has(filename, core) === true) {\n      debug('returning already patched cached module: %s', filename)\n      return self._cache.get(filename, core)\n    }\n\n    // Check if this module has a patcher in-progress already.\n    // Otherwise, mark this module as patching in-progress.\n    const isPatching = patching.has(filename)\n    if (isPatching === false) {\n      patching.add(filename)\n    }\n\n    const exports = coreOnly\n      ? self._origGetBuiltinModule.apply(this, args)\n      : self._origRequire.apply(this, args)\n\n    // If it's already patched, just return it as-is.\n    if (isPatching === true) {\n      debug('module is in the process of being patched already - ignoring: %s', filename)\n      return exports\n    }\n\n    // The module has already been loaded,\n    // so the patching mark can be cleaned up.\n    patching.delete(filename)\n\n    if (core === true) {\n      if (hasWhitelist === true && modules.includes(filename) === false) {\n        debug('ignoring core module not on whitelist: %s', filename)\n        return exports // abort if module name isn't on whitelist\n      }\n      moduleName = filename\n    } else if (hasWhitelist === true && modules.includes(filename)) {\n      // whitelist includes the absolute path to the file including extension\n      const parsedPath = path.parse(filename)\n      moduleName = parsedPath.name\n      basedir = parsedPath.dir\n    } else {\n      const stat = moduleDetailsFromPath(filename)\n      if (stat === undefined) {\n        debug('could not parse filename: %s', filename)\n        return exports // abort if filename could not be parsed\n      }\n      moduleName = stat.name\n      basedir = stat.basedir\n\n      // Ex: require('foo/lib/../bar.js')\n      // moduleName = 'foo'\n      // fullModuleName = 'foo/bar'\n      const fullModuleName = resolveModuleName(stat)\n\n      debug('resolved filename to module: %s (id: %s, resolved: %s, basedir: %s)', moduleName, id, fullModuleName, basedir)\n\n      let matchFound = false\n      if (hasWhitelist) {\n        if (!id.startsWith('.') && modules.includes(id)) {\n          // Not starting with '.' means `id` is identifying a module path,\n          // as opposed to a local file path. (Note: I'm not sure about\n          // absolute paths, but those are handled above.)\n          // If this `id` is in `modules`, then this could be a match to an\n          // package \"exports\" entry point that wouldn't otherwise match below.\n          moduleName = id\n          matchFound = true\n        }\n\n        // abort if module name isn't on whitelist\n        if (!modules.includes(moduleName) && !modules.includes(fullModuleName)) {\n          return exports\n        }\n\n        if (modules.includes(fullModuleName) && fullModuleName !== moduleName) {\n          // if we get to this point, it means that we're requiring a whitelisted sub-module\n          moduleName = fullModuleName\n          matchFound = true\n        }\n      }\n\n      if (!matchFound) {\n        // figure out if this is the main module file, or a file inside the module\n        let res\n        try {\n          res = require.resolve(moduleName, { paths: [basedir] })\n        } catch (e) {\n          debug('could not resolve module: %s', moduleName)\n          self._cache.set(filename, exports, core)\n          return exports // abort if module could not be resolved (e.g. no main in package.json and no index.js file)\n        }\n\n        if (res !== filename) {\n          // this is a module-internal file\n          if (internals === true) {\n            // use the module-relative path to the file, prefixed by original module name\n            moduleName = moduleName + path.sep + path.relative(basedir, filename)\n            debug('preparing to process require of internal file: %s', moduleName)\n          } else {\n            debug('ignoring require of non-main module file: %s', res)\n            self._cache.set(filename, exports, core)\n            return exports // abort if not main module file\n          }\n        }\n      }\n    }\n\n    // ensure that the cache entry is assigned a value before calling\n    // onrequire, in case calling onrequire requires the same module.\n    self._cache.set(filename, exports, core)\n    debug('calling require hook: %s', moduleName)\n    const patchedExports = onrequire(exports, moduleName, basedir)\n    self._cache.set(filename, patchedExports, core)\n\n    debug('returning module: %s', moduleName)\n    return patchedExports\n  }\n}\n\nHook.prototype.unhook = function () {\n  this._unhooked = true\n\n  if (this._require === Module.prototype.require) {\n    Module.prototype.require = this._origRequire\n    debug('require unhook successful')\n  } else {\n    debug('require unhook unsuccessful')\n  }\n\n  if (process.getBuiltinModule !== undefined) {\n    if (this._getBuiltinModule === process.getBuiltinModule) {\n      process.getBuiltinModule = this._origGetBuiltinModule\n      debug('process.getBuiltinModule unhook successful')\n    } else {\n      debug('process.getBuiltinModule unhook unsuccessful')\n    }\n  }\n}\n\nfunction resolveModuleName (stat) {\n  const normalizedPath = path.sep !== '/' ? stat.path.split(path.sep).join('/') : stat.path\n  return path.posix.join(stat.name, normalizedPath).replace(normalize, '')\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Hooked } from './RequireInTheMiddleSingleton';\n\nexport const ModuleNameSeparator = '/';\n\n/**\n * Node in a `ModuleNameTrie`\n */\nclass ModuleNameTrieNode {\n  hooks: Array<{ hook: Hooked; insertedId: number }> = [];\n  children: Map<string, ModuleNameTrieNode> = new Map();\n}\n\ntype ModuleNameTrieSearchOptions = {\n  /**\n   * Whether to return the results in insertion order\n   */\n  maintainInsertionOrder?: boolean;\n  /**\n   * Whether to return only full matches\n   */\n  fullOnly?: boolean;\n};\n\n/**\n * Trie containing nodes that represent a part of a module name (i.e. the parts separated by forward slash)\n */\nexport class ModuleNameTrie {\n  private _trie: ModuleNameTrieNode = new ModuleNameTrieNode();\n  private _counter: number = 0;\n\n  /**\n   * Insert a module hook into the trie\n   *\n   * @param {Hooked} hook Hook\n   */\n  insert(hook: Hooked) {\n    let trieNode = this._trie;\n\n    for (const moduleNamePart of hook.moduleName.split(ModuleNameSeparator)) {\n      let nextNode = trieNode.children.get(moduleNamePart);\n      if (!nextNode) {\n        nextNode = new ModuleNameTrieNode();\n        trieNode.children.set(moduleNamePart, nextNode);\n      }\n      trieNode = nextNode;\n    }\n    trieNode.hooks.push({ hook, insertedId: this._counter++ });\n  }\n\n  /**\n   * Search for matching hooks in the trie\n   *\n   * @param {string} moduleName Module name\n   * @param {boolean} maintainInsertionOrder Whether to return the results in insertion order\n   * @param {boolean} fullOnly Whether to return only full matches\n   * @returns {Hooked[]} Matching hooks\n   */\n  search(\n    moduleName: string,\n    { maintainInsertionOrder, fullOnly }: ModuleNameTrieSearchOptions = {}\n  ): Hooked[] {\n    let trieNode = this._trie;\n    const results: ModuleNameTrieNode['hooks'] = [];\n    let foundFull = true;\n\n    for (const moduleNamePart of moduleName.split(ModuleNameSeparator)) {\n      const nextNode = trieNode.children.get(moduleNamePart);\n      if (!nextNode) {\n        foundFull = false;\n        break;\n      }\n      if (!fullOnly) {\n        results.push(...nextNode.hooks);\n      }\n      trieNode = nextNode;\n    }\n\n    if (fullOnly && foundFull) {\n      results.push(...trieNode.hooks);\n    }\n\n    if (results.length === 0) {\n      return [];\n    }\n    if (results.length === 1) {\n      return [results[0].hook];\n    }\n    if (maintainInsertionOrder) {\n      results.sort((a, b) => a.insertedId - b.insertedId);\n    }\n    return results.map(({ hook }) => hook);\n  }\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { OnRequireFn } from 'require-in-the-middle';\nimport { Hook } from 'require-in-the-middle';\nimport * as path from 'path';\nimport { ModuleNameTrie, ModuleNameSeparator } from './ModuleNameTrie';\n\nexport type Hooked = {\n  moduleName: string;\n  onRequire: OnRequireFn;\n};\n\n/**\n * Whether Mocha is running in this process\n * Inspired by https://github.com/AndreasPizsa/detect-mocha\n *\n * @type {boolean}\n */\nconst isMocha = [\n  'afterEach',\n  'after',\n  'beforeEach',\n  'before',\n  'describe',\n  'it',\n].every(fn => {\n  // @ts-expect-error TS7053: Element implicitly has an 'any' type\n  return typeof global[fn] === 'function';\n});\n\n/**\n * Singleton class for `require-in-the-middle`\n * Allows instrumentation plugins to patch modules with only a single `require` patch\n * WARNING: Because this class will create its own `require-in-the-middle` (RITM) instance,\n * we should minimize the number of new instances of this class.\n * Multiple instances of `@opentelemetry/instrumentation` (e.g. multiple versions) in a single process\n * will result in multiple instances of RITM, which will have an impact\n * on the performance of instrumentation hooks being applied.\n */\nexport class RequireInTheMiddleSingleton {\n  private _moduleNameTrie: ModuleNameTrie = new ModuleNameTrie();\n  private static _instance?: RequireInTheMiddleSingleton;\n\n  private constructor() {\n    this._initialize();\n  }\n\n  private _initialize() {\n    new Hook(\n      // Intercept all `require` calls; we will filter the matching ones below\n      null,\n      { internals: true },\n      (exports, name, basedir) => {\n        // For internal files on Windows, `name` will use backslash as the path separator\n        const normalizedModuleName = normalizePathSeparators(name);\n\n        const matches = this._moduleNameTrie.search(normalizedModuleName, {\n          maintainInsertionOrder: true,\n          // For core modules (e.g. `fs`), do not match on sub-paths (e.g. `fs/promises').\n          // This matches the behavior of `require-in-the-middle`.\n          // `basedir` is always `undefined` for core modules.\n          fullOnly: basedir === undefined,\n        });\n\n        for (const { onRequire } of matches) {\n          exports = onRequire(exports, name, basedir);\n        }\n\n        return exports;\n      }\n    );\n  }\n\n  /**\n   * Register a hook with `require-in-the-middle`\n   *\n   * @param {string} moduleName Module name\n   * @param {OnRequireFn} onRequire Hook function\n   * @returns {Hooked} Registered hook\n   */\n  register(moduleName: string, onRequire: OnRequireFn): Hooked {\n    const hooked = { moduleName, onRequire };\n    this._moduleNameTrie.insert(hooked);\n    return hooked;\n  }\n\n  /**\n   * Get the `RequireInTheMiddleSingleton` singleton\n   *\n   * @returns {RequireInTheMiddleSingleton} Singleton of `RequireInTheMiddleSingleton`\n   */\n  static getInstance(): RequireInTheMiddleSingleton {\n    // Mocha runs all test suites in the same process\n    // This prevents test suites from sharing a singleton\n    if (isMocha) return new RequireInTheMiddleSingleton();\n\n    return (this._instance =\n      this._instance ?? new RequireInTheMiddleSingleton());\n  }\n}\n\n/**\n * Normalize the path separators to forward slash in a module name or path\n *\n * @param {string} moduleNameOrPath Module name or path\n * @returns {string} Normalized module name or path\n */\nfunction normalizePathSeparators(moduleNameOrPath: string): string {\n  return path.sep !== ModuleNameSeparator\n    ? moduleNameOrPath.split(path.sep).join(ModuleNameSeparator)\n    : moduleNameOrPath;\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ShimWrapped } from './types';\n\n/**\n * function to execute patched function and being able to catch errors\n * @param execute - function to be executed\n * @param onFinish - callback to run when execute finishes\n */\nexport function safeExecuteInTheMiddle<T>(\n  execute: () => T,\n  onFinish: (e: Error | undefined, result: T | undefined) => void,\n  preventThrowingError?: boolean\n): T {\n  let error: Error | undefined;\n  let result: T | undefined;\n  try {\n    result = execute();\n  } catch (e) {\n    error = e;\n  } finally {\n    onFinish(error, result);\n    if (error && !preventThrowingError) {\n      // eslint-disable-next-line no-unsafe-finally\n      throw error;\n    }\n    // eslint-disable-next-line no-unsafe-finally\n    return result as T;\n  }\n}\n\n/**\n * Async function to execute patched function and being able to catch errors\n * @param execute - function to be executed\n * @param onFinish - callback to run when execute finishes\n */\nexport async function safeExecuteInTheMiddleAsync<T>(\n  execute: () => T,\n  onFinish: (e: Error | undefined, result: T | undefined) => void,\n  preventThrowingError?: boolean\n): Promise<T> {\n  let error: Error | undefined;\n  let result: T | undefined;\n  try {\n    result = await execute();\n  } catch (e) {\n    error = e;\n  } finally {\n    onFinish(error, result);\n    if (error && !preventThrowingError) {\n      // eslint-disable-next-line no-unsafe-finally\n      throw error;\n    }\n    // eslint-disable-next-line no-unsafe-finally\n    return result as T;\n  }\n}\n/**\n * Checks if certain function has been already wrapped\n * @param func\n */\nexport function isWrapped(func: unknown): func is ShimWrapped {\n  return (\n    typeof func === 'function' &&\n    typeof (func as ShimWrapped).__original === 'function' &&\n    typeof (func as ShimWrapped).__unwrap === 'function' &&\n    (func as ShimWrapped).__wrapped === true\n  );\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as types from '../../types';\nimport * as path from 'path';\nimport { types as utilTypes } from 'util';\nimport { satisfies } from '../../semver';\nimport { wrap, unwrap, massWrap, massUnwrap } from '../../shimmer';\nimport { InstrumentationAbstract } from '../../instrumentation';\nimport {\n  RequireInTheMiddleSingleton,\n  Hooked,\n} from './RequireInTheMiddleSingleton';\nimport type { HookFn } from 'import-in-the-middle';\nimport { Hook as HookImport } from 'import-in-the-middle';\nimport {\n  InstrumentationConfig,\n  InstrumentationModuleDefinition,\n} from '../../types';\nimport { diag } from '@opentelemetry/api';\nimport type { OnRequireFn } from 'require-in-the-middle';\nimport { Hook as HookRequire } from 'require-in-the-middle';\nimport { readFileSync } from 'fs';\nimport { isWrapped } from '../../utils';\n\n/**\n * Base abstract class for instrumenting node plugins\n */\nexport abstract class InstrumentationBase<\n    ConfigType extends InstrumentationConfig = InstrumentationConfig,\n  >\n  extends InstrumentationAbstract<ConfigType>\n  implements types.Instrumentation<ConfigType>\n{\n  private _modules: InstrumentationModuleDefinition[];\n  private _hooks: (Hooked | HookRequire)[] = [];\n  private _requireInTheMiddleSingleton: RequireInTheMiddleSingleton =\n    RequireInTheMiddleSingleton.getInstance();\n  private _enabled = false;\n\n  constructor(\n    instrumentationName: string,\n    instrumentationVersion: string,\n    config: ConfigType\n  ) {\n    super(instrumentationName, instrumentationVersion, config);\n\n    let modules = this.init();\n\n    if (modules && !Array.isArray(modules)) {\n      modules = [modules];\n    }\n\n    this._modules = (modules as InstrumentationModuleDefinition[]) || [];\n\n    if (this._config.enabled) {\n      this.enable();\n    }\n  }\n\n  protected override _wrap: typeof wrap = (moduleExports, name, wrapper) => {\n    if (isWrapped(moduleExports[name])) {\n      this._unwrap(moduleExports, name);\n    }\n    if (!utilTypes.isProxy(moduleExports)) {\n      return wrap(moduleExports, name, wrapper);\n    } else {\n      const wrapped = wrap(Object.assign({}, moduleExports), name, wrapper);\n      Object.defineProperty(moduleExports, name, {\n        value: wrapped,\n      });\n      return wrapped;\n    }\n  };\n\n  protected override _unwrap: typeof unwrap = (moduleExports, name) => {\n    if (!utilTypes.isProxy(moduleExports)) {\n      return unwrap(moduleExports, name);\n    } else {\n      return Object.defineProperty(moduleExports, name, {\n        value: moduleExports[name],\n      });\n    }\n  };\n\n  protected override _massWrap: typeof massWrap = (\n    moduleExportsArray,\n    names,\n    wrapper\n  ) => {\n    if (!moduleExportsArray) {\n      diag.error('must provide one or more modules to patch');\n      return;\n    } else if (!Array.isArray(moduleExportsArray)) {\n      moduleExportsArray = [moduleExportsArray];\n    }\n\n    if (!(names && Array.isArray(names))) {\n      diag.error('must provide one or more functions to wrap on modules');\n      return;\n    }\n\n    moduleExportsArray.forEach(moduleExports => {\n      names.forEach(name => {\n        this._wrap(moduleExports, name, wrapper);\n      });\n    });\n  };\n\n  protected override _massUnwrap: typeof massUnwrap = (\n    moduleExportsArray,\n    names\n  ) => {\n    if (!moduleExportsArray) {\n      diag.error('must provide one or more modules to patch');\n      return;\n    } else if (!Array.isArray(moduleExportsArray)) {\n      moduleExportsArray = [moduleExportsArray];\n    }\n\n    if (!(names && Array.isArray(names))) {\n      diag.error('must provide one or more functions to wrap on modules');\n      return;\n    }\n\n    moduleExportsArray.forEach(moduleExports => {\n      names.forEach(name => {\n        this._unwrap(moduleExports, name);\n      });\n    });\n  };\n\n  private _warnOnPreloadedModules(): void {\n    this._modules.forEach((module: InstrumentationModuleDefinition) => {\n      const { name } = module;\n      try {\n        const resolvedModule = require.resolve(name);\n        if (require.cache[resolvedModule]) {\n          // Module is already cached, which means the instrumentation hook might not work\n          this._diag.warn(\n            `Module ${name} has been loaded before ${this.instrumentationName} so it might not work, please initialize it before requiring ${name}`\n          );\n        }\n      } catch {\n        // Module isn't available, we can simply skip\n      }\n    });\n  }\n\n  private _extractPackageVersion(baseDir: string): string | undefined {\n    try {\n      const json = readFileSync(path.join(baseDir, 'package.json'), {\n        encoding: 'utf8',\n      });\n      const version = JSON.parse(json).version;\n      return typeof version === 'string' ? version : undefined;\n    } catch {\n      diag.warn('Failed extracting version', baseDir);\n    }\n\n    return undefined;\n  }\n\n  private _onRequire<T>(\n    module: InstrumentationModuleDefinition,\n    exports: T,\n    name: string,\n    baseDir?: string | void\n  ): T {\n    if (!baseDir) {\n      if (typeof module.patch === 'function') {\n        module.moduleExports = exports;\n        if (this._enabled) {\n          this._diag.debug(\n            'Applying instrumentation patch for nodejs core module on require hook',\n            {\n              module: module.name,\n            }\n          );\n          return module.patch(exports);\n        }\n      }\n      return exports;\n    }\n\n    const version = this._extractPackageVersion(baseDir);\n    module.moduleVersion = version;\n    if (module.name === name) {\n      // main module\n      if (\n        isSupported(module.supportedVersions, version, module.includePrerelease)\n      ) {\n        if (typeof module.patch === 'function') {\n          module.moduleExports = exports;\n          if (this._enabled) {\n            this._diag.debug(\n              'Applying instrumentation patch for module on require hook',\n              {\n                module: module.name,\n                version: module.moduleVersion,\n                baseDir,\n              }\n            );\n            return module.patch(exports, module.moduleVersion);\n          }\n        }\n      }\n      return exports;\n    }\n    // internal file\n    const files = module.files ?? [];\n    const normalizedName = path.normalize(name);\n    const supportedFileInstrumentations = files\n      .filter(f => f.name === normalizedName)\n      .filter(f =>\n        isSupported(f.supportedVersions, version, module.includePrerelease)\n      );\n    return supportedFileInstrumentations.reduce<T>((patchedExports, file) => {\n      file.moduleExports = patchedExports;\n      if (this._enabled) {\n        this._diag.debug(\n          'Applying instrumentation patch for nodejs module file on require hook',\n          {\n            module: module.name,\n            version: module.moduleVersion,\n            fileName: file.name,\n            baseDir,\n          }\n        );\n\n        // patch signature is not typed, so we cast it assuming it's correct\n        return file.patch(patchedExports, module.moduleVersion) as T;\n      }\n      return patchedExports;\n    }, exports);\n  }\n\n  public enable(): void {\n    if (this._enabled) {\n      return;\n    }\n    this._enabled = true;\n\n    // already hooked, just call patch again\n    if (this._hooks.length > 0) {\n      for (const module of this._modules) {\n        if (typeof module.patch === 'function' && module.moduleExports) {\n          this._diag.debug(\n            'Applying instrumentation patch for nodejs module on instrumentation enabled',\n            {\n              module: module.name,\n              version: module.moduleVersion,\n            }\n          );\n          module.patch(module.moduleExports, module.moduleVersion);\n        }\n        for (const file of module.files) {\n          if (file.moduleExports) {\n            this._diag.debug(\n              'Applying instrumentation patch for nodejs module file on instrumentation enabled',\n              {\n                module: module.name,\n                version: module.moduleVersion,\n                fileName: file.name,\n              }\n            );\n            file.patch(file.moduleExports, module.moduleVersion);\n          }\n        }\n      }\n      return;\n    }\n\n    this._warnOnPreloadedModules();\n    for (const module of this._modules) {\n      const hookFn: HookFn = (exports, name, baseDir) => {\n        if (!baseDir && path.isAbsolute(name)) {\n          const parsedPath = path.parse(name);\n          name = parsedPath.name;\n          baseDir = parsedPath.dir;\n        }\n        return this._onRequire<typeof exports>(module, exports, name, baseDir);\n      };\n      const onRequire: OnRequireFn = (exports, name, baseDir) => {\n        return this._onRequire<typeof exports>(module, exports, name, baseDir);\n      };\n\n      // `RequireInTheMiddleSingleton` does not support absolute paths.\n      // For an absolute paths, we must create a separate instance of the\n      // require-in-the-middle `Hook`.\n      const hook = path.isAbsolute(module.name)\n        ? new HookRequire([module.name], { internals: true }, onRequire)\n        : this._requireInTheMiddleSingleton.register(module.name, onRequire);\n\n      this._hooks.push(hook);\n      const esmHook = new HookImport(\n        [module.name],\n        { internals: false },\n        <HookFn>hookFn\n      );\n      this._hooks.push(esmHook);\n    }\n  }\n\n  public disable(): void {\n    if (!this._enabled) {\n      return;\n    }\n    this._enabled = false;\n\n    for (const module of this._modules) {\n      if (typeof module.unpatch === 'function' && module.moduleExports) {\n        this._diag.debug(\n          'Removing instrumentation patch for nodejs module on instrumentation disabled',\n          {\n            module: module.name,\n            version: module.moduleVersion,\n          }\n        );\n        module.unpatch(module.moduleExports, module.moduleVersion);\n      }\n      for (const file of module.files) {\n        if (file.moduleExports) {\n          this._diag.debug(\n            'Removing instrumentation patch for nodejs module file on instrumentation disabled',\n            {\n              module: module.name,\n              version: module.moduleVersion,\n              fileName: file.name,\n            }\n          );\n          file.unpatch(file.moduleExports, module.moduleVersion);\n        }\n      }\n    }\n  }\n\n  public isEnabled(): boolean {\n    return this._enabled;\n  }\n}\n\nfunction isSupported(\n  supportedVersions: string[],\n  version?: string,\n  includePrerelease?: boolean\n): boolean {\n  if (typeof version === 'undefined') {\n    // If we don't have the version, accept the wildcard case only\n    return supportedVersions.includes('*');\n  }\n\n  return supportedVersions.some(supportedVersion => {\n    return satisfies(version, supportedVersion, { includePrerelease });\n  });\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport { normalize } from 'path';\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport { InstrumentationBase } from './instrumentation';\nexport { normalize } from './normalize';\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport { InstrumentationBase, normalize } from './node';\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  InstrumentationModuleDefinition,\n  InstrumentationModuleFile,\n} from './types';\n\nexport class InstrumentationNodeModuleDefinition\n  implements InstrumentationModuleDefinition\n{\n  files: InstrumentationModuleFile[];\n  constructor(\n    public name: string,\n    public supportedVersions: string[],\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    public patch?: (exports: any, moduleVersion?: string) => any,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    public unpatch?: (exports: any, moduleVersion?: string) => void,\n    files?: InstrumentationModuleFile[]\n  ) {\n    this.files = files || [];\n  }\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { InstrumentationModuleFile } from './types';\nimport { normalize } from './platform/index';\n\nexport class InstrumentationNodeModuleFile\n  implements InstrumentationModuleFile\n{\n  public name: string;\n  constructor(\n    name: string,\n    public supportedVersions: string[],\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    public patch: (moduleExports: any, moduleVersion?: string) => any,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    public unpatch: (moduleExports?: any, moduleVersion?: string) => void\n  ) {\n    this.name = normalize(name);\n  }\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum SemconvStability {\n  /** Emit only stable semantic conventions. */\n  STABLE = 0x1,\n  /** Emit only old semantic conventions. */\n  OLD = 0x2,\n  /** Emit both stable and old semantic conventions. */\n  DUPLICATE = 0x1 | 0x2,\n}\n\n// Common namespaces mentioned in semantic-conventions docs, but allow\n// other custom strings.\ntype SemConvStabilityNamespace =\n  | 'http'\n  | 'messaging'\n  | 'database'\n  | 'k8s'\n  | (string & {});\n\n/**\n * Determine the appropriate semconv stability for the given namespace.\n *\n * This will parse the given string of comma-separated values (often\n * `process.env.OTEL_SEMCONV_STABILITY_OPT_IN`) looking for the `${namespace}`\n * or `${namespace}/dup` tokens. This is a pattern defined by a number of\n * non-normative semconv documents.\n *\n * For example:\n * - namespace 'http': https://opentelemetry.io/docs/specs/semconv/non-normative/http-migration/\n * - namespace 'database': https://opentelemetry.io/docs/specs/semconv/non-normative/database-migration/\n * - namespace 'k8s': https://opentelemetry.io/docs/specs/semconv/non-normative/k8s-migration/\n *\n * Usage:\n *\n *  import {SemconvStability, semconvStabilityFromStr} from '@opentelemetry/instrumentation';\n *\n *  export class FooInstrumentation extends InstrumentationBase<FooInstrumentationConfig> {\n *    private _semconvStability: SemconvStability;\n *    constructor(config: FooInstrumentationConfig = {}) {\n *      super('@opentelemetry/instrumentation-foo', VERSION, config);\n *\n *      // When supporting the OTEL_SEMCONV_STABILITY_OPT_IN envvar\n *      this._semconvStability = semconvStabilityFromStr(\n *        'http',\n *        process.env.OTEL_SEMCONV_STABILITY_OPT_IN\n *      );\n *\n *      // or when supporting a `semconvStabilityOptIn` config option (e.g. for\n *      // the web where there are no envvars).\n *      this._semconvStability = semconvStabilityFromStr(\n *        'http',\n *        config?.semconvStabilityOptIn\n *      );\n *    }\n *  }\n *\n *  // Then, to apply semconv, use the following or similar:\n *  if (this._semconvStability & SemconvStability.OLD) {\n *    // ...\n *  }\n *  if (this._semconvStability & SemconvStability.STABLE) {\n *    // ...\n *  }\n *\n */\nexport function semconvStabilityFromStr(\n  namespace: SemConvStabilityNamespace,\n  str: string | undefined\n) {\n  let semconvStability = SemconvStability.OLD;\n\n  // The same parsing of `str` as `getStringListFromEnv` from the core pkg.\n  const entries = str\n    ?.split(',')\n    .map(v => v.trim())\n    .filter(s => s !== '');\n  for (const entry of entries ?? []) {\n    if (entry.toLowerCase() === namespace + '/dup') {\n      // DUPLICATE takes highest precedence.\n      semconvStability = SemconvStability.DUPLICATE;\n      break;\n    } else if (entry.toLowerCase() === namespace) {\n      semconvStability = SemconvStability.STABLE;\n    }\n  }\n\n  return semconvStability;\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport { registerInstrumentations } from './autoLoader';\nexport { InstrumentationBase } from './platform/index';\nexport { InstrumentationNodeModuleDefinition } from './instrumentationNodeModuleDefinition';\nexport { InstrumentationNodeModuleFile } from './instrumentationNodeModuleFile';\nexport type {\n  Instrumentation,\n  InstrumentationConfig,\n  InstrumentationModuleDefinition,\n  InstrumentationModuleFile,\n  ShimWrapped,\n  SpanCustomizationHook,\n} from './types';\nexport type { AutoLoaderOptions, AutoLoaderResult } from './types_internal';\nexport {\n  isWrapped,\n  safeExecuteInTheMiddle,\n  safeExecuteInTheMiddleAsync,\n} from './utils';\nexport { SemconvStability, semconvStabilityFromStr } from './semconvStability';\n", "import { defineConfig } from \"@trigger.dev/sdk\";\nimport { prismaExtension } from \"@trigger.dev/build/extensions/prisma\";\nimport { PrismaInstrumentation } from \"@prisma/instrumentation\";\n\nexport default defineConfig({\n  project: process.env.TRIGGER_PROJECT_REF!,\n  runtime: \"node\",\n  logLevel: \"info\",\n  maxDuration: 3600, // in seconds (1 hour)\n  // The directories where your trigger tasks are located\n  dirs: [\"./src/trigger\"],\n  telemetry: {\n    instrumentations: [new PrismaInstrumentation()],\n  },\n  build: {},\n});\nexport const resolveEnvVars = undefined;", "// src/PrismaInstrumentation.ts\nimport { trace as trace2 } from \"@opentelemetry/api\";\nimport {\n  InstrumentationBase,\n  InstrumentationNodeModuleDefinition\n} from \"@opentelemetry/instrumentation\";\n\n// src/ActiveTracingHelper.ts\nimport {\n  context as _context,\n  SpanKind,\n  trace\n} from \"@opentelemetry/api\";\nvar showAllTraces = process.env.PRISMA_SHOW_ALL_TRACES === \"true\";\nvar nonSampledTraceParent = `00-10-10-00`;\nfunction engineSpanKindToOtelSpanKind(engineSpanKind) {\n  switch (engineSpanKind) {\n    case \"client\":\n      return SpanKind.CLIENT;\n    case \"internal\":\n    default:\n      return SpanKind.INTERNAL;\n  }\n}\nvar ActiveTracingHelper = class {\n  tracerProvider;\n  ignoreSpanTypes;\n  constructor({ tracerProvider, ignoreSpanTypes }) {\n    this.tracerProvider = tracerProvider;\n    this.ignoreSpanTypes = ignoreSpanTypes;\n  }\n  isEnabled() {\n    return true;\n  }\n  getTraceParent(context) {\n    const span = trace.getSpanContext(context ?? _context.active());\n    if (span) {\n      return `00-${span.traceId}-${span.spanId}-0${span.traceFlags}`;\n    }\n    return nonSampledTraceParent;\n  }\n  dispatchEngineSpans(spans) {\n    const tracer = this.tracerProvider.getTracer(\"prisma\");\n    const linkIds = /* @__PURE__ */ new Map();\n    const roots = spans.filter((span) => span.parentId === null);\n    for (const root of roots) {\n      dispatchEngineSpan(tracer, root, spans, linkIds, this.ignoreSpanTypes);\n    }\n  }\n  getActiveContext() {\n    return _context.active();\n  }\n  runInChildSpan(options, callback) {\n    if (typeof options === \"string\") {\n      options = { name: options };\n    }\n    if (options.internal && !showAllTraces) {\n      return callback();\n    }\n    const tracer = this.tracerProvider.getTracer(\"prisma\");\n    const context = options.context ?? this.getActiveContext();\n    const name = `prisma:client:${options.name}`;\n    if (shouldIgnoreSpan(name, this.ignoreSpanTypes)) {\n      return callback();\n    }\n    if (options.active === false) {\n      const span = tracer.startSpan(name, options, context);\n      return endSpan(span, callback(span, context));\n    }\n    return tracer.startActiveSpan(name, options, (span) => endSpan(span, callback(span, context)));\n  }\n};\nfunction dispatchEngineSpan(tracer, engineSpan, allSpans, linkIds, ignoreSpanTypes) {\n  if (shouldIgnoreSpan(engineSpan.name, ignoreSpanTypes)) return;\n  const spanOptions = {\n    attributes: engineSpan.attributes,\n    kind: engineSpanKindToOtelSpanKind(engineSpan.kind),\n    startTime: engineSpan.startTime\n  };\n  tracer.startActiveSpan(engineSpan.name, spanOptions, (span) => {\n    linkIds.set(engineSpan.id, span.spanContext().spanId);\n    if (engineSpan.links) {\n      span.addLinks(\n        engineSpan.links.flatMap((link) => {\n          const linkedId = linkIds.get(link);\n          if (!linkedId) {\n            return [];\n          }\n          return {\n            context: {\n              spanId: linkedId,\n              traceId: span.spanContext().traceId,\n              traceFlags: span.spanContext().traceFlags\n            }\n          };\n        })\n      );\n    }\n    const children = allSpans.filter((s) => s.parentId === engineSpan.id);\n    for (const child of children) {\n      dispatchEngineSpan(tracer, child, allSpans, linkIds, ignoreSpanTypes);\n    }\n    span.end(engineSpan.endTime);\n  });\n}\nfunction endSpan(span, result) {\n  if (isPromiseLike(result)) {\n    return result.then(\n      (value) => {\n        span.end();\n        return value;\n      },\n      (reason) => {\n        span.end();\n        throw reason;\n      }\n    );\n  }\n  span.end();\n  return result;\n}\nfunction isPromiseLike(value) {\n  return value != null && typeof value[\"then\"] === \"function\";\n}\nfunction shouldIgnoreSpan(spanName, ignoreSpanTypes) {\n  return ignoreSpanTypes.some(\n    (pattern) => typeof pattern === \"string\" ? pattern === spanName : pattern.test(spanName)\n  );\n}\n\n// package.json\nvar package_default = {\n  name: \"@prisma/instrumentation\",\n  version: \"7.0.0\",\n  description: \"OpenTelemetry compliant instrumentation for Prisma Client\",\n  main: \"dist/index.js\",\n  module: \"dist/index.mjs\",\n  types: \"dist/index.d.ts\",\n  exports: {\n    \".\": {\n      require: {\n        types: \"./dist/index.d.ts\",\n        default: \"./dist/index.js\"\n      },\n      import: {\n        types: \"./dist/index.d.ts\",\n        default: \"./dist/index.mjs\"\n      }\n    }\n  },\n  license: \"Apache-2.0\",\n  homepage: \"https://www.prisma.io\",\n  repository: {\n    type: \"git\",\n    url: \"https://github.com/prisma/prisma.git\",\n    directory: \"packages/instrumentation\"\n  },\n  bugs: \"https://github.com/prisma/prisma/issues\",\n  devDependencies: {\n    \"@opentelemetry/api\": \"1.9.0\",\n    \"@prisma/internals\": \"workspace:*\",\n    \"@types/node\": \"~20.19.24\",\n    typescript: \"5.4.5\"\n  },\n  dependencies: {\n    \"@opentelemetry/instrumentation\": \"^0.207.0\"\n  },\n  peerDependencies: {\n    \"@opentelemetry/api\": \"^1.8\"\n  },\n  files: [\n    \"dist\"\n  ],\n  keywords: [\n    \"prisma\",\n    \"instrumentation\",\n    \"opentelemetry\",\n    \"otel\"\n  ],\n  scripts: {\n    dev: \"DEV=true tsx helpers/build.ts\",\n    build: \"tsx helpers/build.ts\",\n    prepublishOnly: \"pnpm run build\",\n    test: \"vitest run\"\n  },\n  sideEffects: false\n};\n\n// src/constants.ts\nvar VERSION = package_default.version;\nvar majorVersion = VERSION.split(\".\")[0];\nvar GLOBAL_INSTRUMENTATION_ACCESSOR_KEY = \"PRISMA_INSTRUMENTATION\";\nvar GLOBAL_VERSIONED_INSTRUMENTATION_ACCESSOR_KEY = `V${majorVersion}_PRISMA_INSTRUMENTATION`;\nvar NAME = package_default.name;\nvar MODULE_NAME = \"@prisma/client\";\n\n// src/PrismaInstrumentation.ts\nvar PrismaInstrumentation = class extends InstrumentationBase {\n  tracerProvider;\n  constructor(config = {}) {\n    super(NAME, VERSION, config);\n  }\n  setTracerProvider(tracerProvider) {\n    this.tracerProvider = tracerProvider;\n  }\n  init() {\n    const module = new InstrumentationNodeModuleDefinition(MODULE_NAME, [VERSION]);\n    return [module];\n  }\n  enable() {\n    const config = this._config;\n    const globalValue = {\n      helper: new ActiveTracingHelper({\n        tracerProvider: this.tracerProvider ?? trace2.getTracerProvider(),\n        ignoreSpanTypes: config.ignoreSpanTypes ?? []\n      })\n    };\n    global[GLOBAL_INSTRUMENTATION_ACCESSOR_KEY] = globalValue;\n    global[GLOBAL_VERSIONED_INSTRUMENTATION_ACCESSOR_KEY] = globalValue;\n  }\n  disable() {\n    delete global[GLOBAL_INSTRUMENTATION_ACCESSOR_KEY];\n    delete global[GLOBAL_VERSIONED_INSTRUMENTATION_ACCESSOR_KEY];\n  }\n  isEnabled() {\n    return Boolean(global[GLOBAL_VERSIONED_INSTRUMENTATION_ACCESSOR_KEY]);\n  }\n};\n\n// src/index.ts\nimport { registerInstrumentations } from \"@opentelemetry/instrumentation\";\nexport {\n  PrismaInstrumentation,\n  registerInstrumentations\n};\n"],
  "mappings": "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",
  "names": ["SeverityNumber", "exports", "exports", "InstrumentationBase", "module", "exports", "InstrumentationNodeModuleDefinition", "SemconvStability", "init_esm", "context"]
}
